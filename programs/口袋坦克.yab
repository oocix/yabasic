dim mapna$(6)data "隔山打牛","乱石嶙峋","掩体之争","隔岸放火","翻山越岭","坑洼战场"for i=1 to 6read mapna$(i)nextbegin=1goto menulabel dimvart0=.05dim m(216)dim score(2)dim pos(2)dim gang(2,10)dim move(2)dim degree(2)dim v(2)dim name$(7)data "常规炮弹","加农炮弹","精确制导","狙击弹","钻地弹","魔法墙","破坏者"for i=1 to 7read name$(i)nextreturnlabel maingosub dimitbegin=0gosub drawmaplabel roundfor pl=1 to 2fn=0w=ran(1)-.5move(pl)=20label waitkeygosub display?@(18,20),"发射状态";if level=0 or pl=1 thenk$=inkey$if k$="keya5" or k$="keya6" then gosub degrees:fiif k$="keya3" or k$="keya4" then gosub vs:fiif k$="keya0" then ? @(18,20),"机动状态";k$=inkey$if k$="keya0" then goto menu:fiif mode<>0 and k$="keya7" then gosub cheat:filabel fnif k$="keya5" or k$="keya6" then gosub gangs:fiif k$="keya3" then gosub moveleft:fiif k$="keya4" then gosub moveright:figosub displayk$=inkey$if k$="keya7" then gosub drawmap:gosub display:?@(18,20),"机动状态";:fiif k$<>"keya0" and k$<>"keya7" then goto fn:fik$=""fiif k$<>"keya7" thengoto waitkeyelsegosub firefielsegosub cpaigosub firefiif score(1)<=0 or score(2)<=0 then goto finish:finext plgoto roundlabel finishif score(1)>score(2) then win=1? @(5,5),"winnner!";elsewin=0? @(5,16),"winner!";fiif mode=2 thenif win=1 thenmapch=mapch+1if mapch=7 then? @(10,10),"恭喜通关"inkey$goto menufi ? @(12,10),"过关!"? @(6,11),"下一关:",mapna$(mapch);inkey$else? @(10,10),"闯关失败"? @(12,11),"重来?";k$=inkey$if k$="keya0" then goto menu:fifi? @(9,12),"loading...";goto mainfiinkey$goto menulabel cheatif inkey$<>"keya6" then return:fiif inkey$<>"keya3" then return:fiif inkey$<>"keya5" then return:fiif inkey$<>"keya4" then return:fiif inkey$<>"keya6" then return:fiif inkey$<>"keya5" then return:fiif inkey$<>"keya7" then return:fivy=ran(10)+50t=(vy+(vy*vy-20*(m(pos(2))-m(pos(1))))^.5)/10vx=-w*t/2-(pos(1)-1-pos(2))/tv(1)=(vx*vx+vy*vy)^.5degree(1)=atan(vy/vx)returnlabel cpaimind=gang(2,0)temp=(ran(2)-1)*(3-level)vy=ran(10)+50t=(vy+(vy*vy-20*(m(pos(1))-m(pos(2))))^.5)/10vx=temp-w*t/2-(pos(2)+1-pos(1))/tv(2)=(vx*vx+vy*vy)^.5degree(2)=atan(vy/vx)+pigosub displayreturnlabel menuclear windowlev=0? @(6,6),"口袋坦克    E+E版"? @(7,10),"播放键:单人游戏"? @(7,12),"停止键:双人游戏"? @(6,16),"版权没有  转载不究"? @(2,18),"数学模型: J 代码:奇天大圣"k$=inkey$if k$="keya3" thenlevel=1label hardnessbox 30,156 to 126,168 ? @(level*6,14),"";if level=1 then ? reverse "新兵";:fiif level=2 then ? reverse "老兵";:fiif level=3 then ? reverse "骨灰";:fik$=inkey$if k$="keya5" then level=level-1:fiif k$="keya0" then goto menu:fiif k$="keya6" then level=level+1:fiif level=0 then level=3:fiif level=4 then level=1:fiif k$<>"keya7" then goto hardness:fimode=1label choosemodebox 30,156 to 126,168? @(mode*8-2,14),"";if mode=1 then ? reverse "开始作战";:fiif mode=2 then ? reverse "战役模式";:fik$=inkey$if k$="keya5" or k$="keya6" then mode=mode+1:fiif mode=3 then mode=1:fiif k$="keya0" then goto menu:fiif k$<>"keya7" then goto choosemode:fimapch=1if mode=1 then gosub choosemap:figoto main fiif k$="keya4" then mode=0:level=0:gosub choosemap:goto main:fiif k$="keya0" then ?@(1,20),"";:end:figoto menulabel choosemapclear screenfor i=1 to 3? @(3,9+i),i,".",mapna$(i),"   ";nextfor i=4 to 6? @(16,6+i),i,".",mapna$(i);nextcm=1label cm?@(3,5)"选定第 ",cm," 号地图"k$=inkey$if k$="keya5" and cm>1 then:cm=cm-1:goto cmelsif k$="keya6" and cm<6 then:cm=cm+1:goto cmelsif k$="keya7" then:mapch=cm? @(11,13),"loading...";returnelse:goto cm:filabel firetemp1=m(pos(3-pl)-8*pl+12)m(pos(3-pl)-8*pl+12)=m(pos(3-pl))+6m(pos(3-pl))=m(pos(3-pl))+6temp=gang(pl,mind)if mind<gang(pl,0) and mind>1 thenfor i=mind to gang(pl,0)-1gang(pl,i)=gang(pl,i+1)nextfiif temp>1 thengang(pl,0)=gang(pl,0)-1fimind=1vx=v(pl)*cos(degree(pl))vy=v(pl)*sin(degree(pl))x=pos(pl)y=148-m(x)t=0new curvelabel dandaot=t+t0xx=x+vx*t+.5*w*t*tyy=y-vy*t+5*t*tif temp=3 thenif pl=1 and xx>pos(2) then xx=pos(2):x=xx:w=0:vx=0:fiif pl=2 and xx<pos(1) then xx=pos(1):w=0:x=xx:vx=0:fifiif temp=4 thenline to 160-yy,xxelseif temp>4 thencircle 160-yy,xx,2elsecircle 160-yy,xx,tempfifiif int(xx)<1 then xx=216:x=x+216:new curve:fiif int(xx)>216 then xx=1:x=x-216:new curve:fiif yy>148-m(int(xx)) then goto out:fiif yy<148 then goto dandao:filabel outm(pos(3-pl)-8*pl+12)=temp1m(pos(3-pl))=m(pos(3-pl))-6if yy>148 and (xx>216 or xx<1) then pause 2:gosub drawmap:return:fiif yy>148 then yy=148:fir=tempif r=3 then r=1:fitemp1=0temp2=0on temp gosub bang1,bang1,bang1,bang4,bang5,bang6,bang7if temp1>0 then? @(6,10),"击中,得分:",temp1,"点";score(3-pl)=score(3-pl)-temp1fiif temp2>0 then? @(6,11),"自杀,扣分:",temp2,"点";score(pl)=score(pl)-temp2fipause 2gosub drawmapreturnlabel bang7for i=1 to 18circle 160-yy,xx,inextfor i=18 to 1 step -1circle 160-yy,xx,inextfor i=1 to 18circle 160-yy,xx,inextx=xxy=yyr=18gosub cleanmapreturnlabel bang6for i=1 to 57line 160-yy+i,xx-2 to 160-yy+i,xx+2if abs(int(pos(1)-xx))<3 thenx=pos(1)-10y=yy-i-2gosub drawleftfiif abs(int(pos(2)-xx))<3 thenx=pos(2)+10y=yy-i-2gosub drawrightfinextfor i=xx-2 to xx+2if i>216 then return:fiif i<1 then i=1:fim(i)=m(i)+57nextreturnlabel bang5yy=yy-8for j=1 to 6r=10-j*1yy=yy+8circle 160-yy,xx,rgosub cleanmapnextif (pl*6-9-xx+pos(pl))^2<100 then temp2=10:fiif (9-pl*6-xx+pos(3-pl))^2<100 then temp1=10:fireturnlabel bang1for i=1 to 4+4*rcircle 160-yy,xx,inexttemp1=((pl*6-9+xx-pos(3-pl))^2+(yy-148+m(pos(3-pl)))^2)^.5if temp1<10+5*r thentemp1=int(18+9*r-1.8*temp1)elsetemp1=0fitemp2=((xx+9-pl*6-pos(pl))^2+(yy-148+m(pos(pl)))^2)^.5if temp2<10+5*r then temp2=int(18+9*r-1.8*temp2)elsetemp2=0fir=4+4*rgosub cleanmapreturnlabel cleanmaptemp=148-yyfor i=xx-r to xx+rif i>216 then return:fiif i<1 then i=1:fitemp4=sqr(r*r-(xx-i)^2)temp3=temp+temp4-m(i)if temp3<0 then temp3=0:fitemp3=2*temp4-temp3if temp3>0 thenm(i)=int(m(i)-temp3)if m(i)<0 then m(i)=0:fifinext ireturnlabel bang4temp1=((xx-pos(3-pl)-9+pl*6)^2+(yy-148+m(pos(3-pl)))^2)if temp1<36 thentemp1=100elsetemp1=0fitemp2=0returnlabel gangsif k$="keya5" thenmind=mind+1if mind>gang(pl,0) then mind=1:fielsemind=mind-1if mind<1 then mind=gang(pl,0):fifireturnlabel vsif k$="keya3" thenv(pl)=v(pl)-1elsev(pl)=v(pl)+1fiif v(pl)<1 then v(pl)=1:fiif v(pl)>100 then v(pl)=100:fireturnlabel degreesif k$="keya6" thenif pl=1 then temp=pi/40else temp=0-pi/40fielseif pl=1 thentemp=0-pi/40 elsetemp=pi/40fifidegree(pl)=degree(pl)+tempreturnlabel moveleftif move(pl)=0 then return:fimove(pl)=move(pl)-1i=pos(pl)-1if pl=2 and i<108 then return:fiif i<10 then return:fiif pl=1 thenx=i-10elsex=i+10fiy=147-m(i)if pl=1 thengosub drawleftelsegosub drawrightfipos(pl)=ireturnlabel moverightif move(pl)=0 then return:fimove(pl)=move(pl)-1i=pos(pl)+1if i>206 then return:fiif pl=1 and i>108 then return:fiif pl=1 thenx=i-10else x=i+10fiy=147-m(i)if pl=1 thengosub drawleftelsegosub drawrightfipos(pl)=ireturnlabel displaybox 63,230 to 87,236box 65,232 to 65+move(pl),234line 65,233 to 65+move(pl),233circle 13,227,12circle 13,227,11circle 13,227,2line 13,215 to 13,218line 13,239 to 13,236line 1,227 to 4,227line 25,227 to 22,227line 13,227 to 13+12*cos(degree(pl)-pi/2),227-12*sin(degree(pl)-pi/2)? @(11,19),name$(gang(pl,mind)),"-",mind,"  ";box 2,108 to 8,214box 4,110 to 6,110+v(pl)line 5,110 to 5,110+v(pl)box 2,28 to 8,72box 4,50 to 6,50+w*40line 5,50 to 5,50+w*40returnlabel dimitif begin=1 then gosub dimvar:figang(1,1)=1for i=2 to 4gang(1,i)=2nextfor i=5 to 6gang(1,i)=3nextgang(1,7)=4gang(1,8)=5gang(1,9)=6gang(1,10)=7gang(1,0)=10for i=0 to 10gang(2,i)=gang(1,i)nextscore(1)=150score(2)=150degree(1)=pi/4degree(2)=pi*.75v(1)=60v(2)=60mind=1on mapch gosub map1,map2,map3,map4,map5,map6returnlabel map3for i=1 to 54m(i)=45nextfor i=54 to 122m(i)=222-1.7*inextfor i=122 to 216m(i)=15nextpos(1)=int(ran(40)+10)pos(2)=int(ran(80)+120)returnlabel map6for i=1 to 216m(i)=130nextfor j=1 to 60xx=int(ran(216))r=int(ran(23))yy=148-m(xx)gosub cleanmapnextpos(1)=int(ran(80)+20)pos(2)=int(ran(80)+116)returnlabel map4for i=1 to 54m(i)=96nextfor i=54 to 81m(i)=int(67+sqr(841-(i-54)^2))nextfor i=81 to 135m(i)=int(37-sqr(841-(i-108)^2))nextfor i=135 to 216m(i)=m(217-i)+15nextpos(1)=int(ran(34)+10)pos(2)=int(ran(34)+162)returnlabel map5for i=1 to 216m(i)=int(74-67*sin(pi/28*(i+17)))nextpos(1)=int(ran(67)+10)pos(2)=int(ran(67)+139)returnlabel map2for i=1 to 216m(i)=int(ran(111))nextpos(1)=int(ran(67)+20)pos(2)=int(ran(67)+139)returnlabel map1for i=1 to 81m(i)=int(i*i/110+15)nextfor i=81 to 108m(i)=int(107-(i-108)^2/23)nextfor i=109 to 216m(i)=m(217-i)nextpos(1)=int(ran(67)+20)pos(2)=int(ran(67)+139)returnlabel drawmapclear windowfor i=1 to 216line 12+m(i),i to 12,inextx=pos(1)-10y=147-m(pos(1))gosub drawleftx=pos(2)+10y=147-m(pos(2))gosub drawright? at(25,1),score(1);? at(24,18),score(2);? at(1,1),"风"? "速"text 0,78,"力"text 0,90,"量"? at(6,20),"油量:";? at(6,19),"炮弹:";returnlabel drawleftbox 160-y,x to 156-y,x+13box 164-y,x+2 to 160-y,x+10line 162-y,x+10 to 165-y,x+18returnlabel drawrightbox 160-y,x to 156-y,x-13box 164-y,x-2 to 160-y,x-10line 162-y,x-10 to 165-y,x-18return